{"timestamp": "2025-12-07T22:11:30.285649", "error_type": "FileNotFoundError", "error_message": "[Errno 2] No such file or directory: 'C:\\\\Users\\\\André\\\\Documents\\\\Agent_Solution_BI\\\\backend\\\\app\\\\data\\\\catalog_focused.json'", "user_message": "Arquivo de dados não encontrado. Verifique se os dados foram carregados.", "context": {"une_id": 2586, "segmento": null, "funcao": "calcular_abastecimento_une"}, "traceback": "Traceback (most recent call last):\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\utils\\error_handler.py\", line 270, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 256, in calcular_abastecimento_une\n    df = _load_data(filters={'une': une_id})\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 112, in _load_data\n    validator = SchemaValidator()\n                ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\validators\\schema_validator.py\", line 59, in __init__\n    self.catalog = self._load_catalog()\n                   ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\validators\\schema_validator.py\", line 73, in _load_catalog\n    with open(self.catalog_path, 'r', encoding='utf-8') as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: 'C:\\\\Users\\\\André\\\\Documents\\\\Agent_Solution_BI\\\\backend\\\\app\\\\data\\\\catalog_focused.json'\n"}
{"timestamp": "2025-12-07T22:13:34.499903", "error_type": "ValueError", "error_message": "Schema do arquivo Parquet inválido: [\"Erro ao validar arquivo Parquet 'C:\\\\Users\\\\André\\\\Documents\\\\Agent_Solution_BI\\\\data\\\\parquet\\\\admmat.parquet': 'list' object has no attribute 'items'\"]", "user_message": "Valor inválido encontrado. Verifique os dados de entrada.", "context": {"une_id": 2586, "segmento": null, "funcao": "calcular_abastecimento_une"}, "traceback": "Traceback (most recent call last):\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\utils\\error_handler.py\", line 270, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 256, in calcular_abastecimento_une\n    df = _load_data(filters={'une': une_id})\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 116, in _load_data\n    raise ValueError(f\"Schema do arquivo Parquet inválido: {errors}\")\nValueError: Schema do arquivo Parquet inválido: [\"Erro ao validar arquivo Parquet 'C:\\\\Users\\\\André\\\\Documents\\\\Agent_Solution_BI\\\\data\\\\parquet\\\\admmat.parquet': 'list' object has no attribute 'items'\"]\n"}
{"timestamp": "2025-12-07T22:19:21.417253", "error_type": "UnboundLocalError", "error_message": "cannot access local variable 'reverse_mapping_sql' where it is not associated with a value", "user_message": "Ocorreu um erro ao processar sua solicitação.", "context": {"une_id": 2586, "segmento": null, "funcao": "calcular_abastecimento_une"}, "traceback": "Traceback (most recent call last):\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\utils\\error_handler.py\", line 270, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 268, in calcular_abastecimento_une\n    df = _load_data(filters={'une': une_id})\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 153, in _load_data\n    if col in reverse_mapping_sql:\n              ^^^^^^^^^^^^^^^^^^^\nUnboundLocalError: cannot access local variable 'reverse_mapping_sql' where it is not associated with a value\n"}
{"timestamp": "2025-12-07T22:20:37.537413", "error_type": "NameError", "error_message": "name '_get_data_adapter' is not defined", "user_message": "Ocorreu um erro ao processar sua solicitação.", "context": {"une_id": 2586, "segmento": null, "funcao": "calcular_abastecimento_une"}, "traceback": "Traceback (most recent call last):\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\utils\\error_handler.py\", line 270, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 222, in calcular_abastecimento_une\n    df = _load_data(filters={'une': une_id})\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 60, in _load_data\n    adapter = _get_data_adapter()\n              ^^^^^^^^^^^^^^^^^\nNameError: name '_get_data_adapter' is not defined\n"}
{"timestamp": "2025-12-07T22:23:05.762039", "error_type": "NameError", "error_message": "name 'Path' is not defined", "user_message": "Ocorreu um erro ao processar sua solicitação.", "context": {"une_id": 2586, "segmento": null, "funcao": "calcular_abastecimento_une"}, "traceback": "Traceback (most recent call last):\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\utils\\error_handler.py\", line 270, in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 271, in calcular_abastecimento_une\n    df = _load_data(filters={'une': une_id})\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\André\\Documents\\Agent_Solution_BI\\backend\\app\\core\\tools\\une_tools.py\", line 115, in _load_data\n    parquet_file_stem = Path(adapter['path']).stem\n                        ^^^^\nNameError: name 'Path' is not defined\n"}
