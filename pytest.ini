[pytest]
# ============================================================
# Configuração Principal do Pytest - Caculinha BI
# ============================================================

# Limitar coleta aos diretórios de teste oficiais
testpaths = backend/tests

# Padrão de arquivos de teste
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Diretórios a ignorar na coleta
norecursedirs = 
    backend/scripts
    legacy_quarantine
    frontend-solid
    node_modules
    .git
    .venv
    venv
    __pycache__
    docs
    tools
    .agent

# Modo asyncio automático
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Filtros de warning
filterwarnings =
    ignore:.*:DeprecationWarning:.*site-packages.*
    ignore:.*:UserWarning:.*site-packages.*
    ignore::pydantic.warnings.PydanticDeprecatedSince212
    ignore:.*builtin type SwigPy.*:DeprecationWarning
    ignore:.*builtin type swigvarlink.*:DeprecationWarning

# Opções de execução
addopts = 
    -q 
    --tb=short
    --ignore=backend/tests/e2e/test_chat_flow.py
    --ignore=backend/tests/load/test_30_users.py
    --ignore=backend/tests/test_final_corrected.py
    --ignore=backend/tests/test_final_sse.py
    --ignore=backend/tests/test_tool_config.py
    --ignore=backend/tests/test_tool_selection.py
    --ignore=backend/tests/test_gemini_integration.py
    --ignore=backend/tests/test_integration_dados_reais.py
    --ignore=backend/tests/test_security_resilience.py
    --ignore=backend/tests/test_tool_modernization.py
    --ignore=backend/tests/legacy
    --ignore=backend/tests/e2e
    --ignore=backend/tests/load
    --ignore=backend/tests/unit
    --ignore=backend/tests/integration
    --ignore=backend/tests/test_final_corrected.py
    --ignore=backend/tests/test_final_sse.py
    --ignore=backend/tests/test_tool_config.py
    --ignore=backend/tests/test_tool_selection.py
    --ignore=backend/tests/test_gemini_integration.py
    --ignore=backend/tests/test_integration_dados_reais.py
    --ignore=backend/tests/test_security_resilience.py
    --ignore=backend/tests/test_tool_modernization.py
    --ignore=backend/tests/test_all_phases.py
    --ignore=backend/tests/test_adapters.py
    --ignore=backend/tests/test_agents.py
    --ignore=backend/tests/test_changes.py
    --ignore=backend/tests/test_chat_bi_integration.py
    --ignore=backend/tests/test_chatbi_complete.py
    --ignore=backend/tests/test_dashboard_integration.py
    --ignore=backend/tests/test_flexible_query_limites.py
    --ignore=backend/tests/test_progressivo_chat_bi.py
    --ignore=backend/tests/test_prompt_v4_integration.py
    --ignore=backend/tests/test_purchasing_calculations.py
    --ignore=backend/tests/test_seasonality_segments.py
    --ignore=backend/tests/test_system.py
    --ignore=backend/tests/test_universal_tool_selection.py
    --ignore=backend/tests/test_consultar_dados_flexivel_inputs.py
    --ignore=backend/tests/test_pytest_collection_guard.py
    --ignore=backend/tests/imports


