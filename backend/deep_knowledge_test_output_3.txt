INFO:app.services.chat_service_v3:Inicializando ChatServiceV3 (Metrics-First)...
INFO:app.core.llm_factory:SmartLLM initialized: primary=google, gemini_available=True
INFO:app.services.metrics_calculator:MetricsCalculator inicializado com parquet: C:\Agente_BI\BI_Solution\data\parquet\admmat.parquet
INFO:app.services.chat_service_v3:\u2705 ChatServiceV3 inicializado com sucesso
INFO:app.services.chat_service_v3:[V3] Processando query: 'Quais colunas vocÛ tem acesso no banco de dados?...'
INFO:app.services.query_interpreter:Interpretando query: 'Quais colunas vocÛ tem acesso no banco de dados?...'
INFO:app.services.query_interpreter:HeurÝstica falhou ou baixa confianþa. Usando LLM fallback...
INFO:app.core.llm_gemini_adapter:Gemini adapter inicializado com modelo: gemini-2.5-flash-lite
INFO:app.core.llm_groq_adapter:[OK] GroqLLMAdapter inicializado: llama-3.3-70b-versatile
INFO:app.core.llm_gemini_adapter:Chamada Gemini SDK (tentativa 1/5)
INFO:app.core.llm_gemini_adapter:Chamada Gemini concluÝda.
ERROR:app.services.query_interpreter:Erro na classificaþÒo LLM: Expecting ',' delimiter: line 5 column 4 (char 74)
WARNING:app.services.query_interpreter:Confianþa muito baixa (0.4). Pedindo esclarecimento.
WARNING:app.services.chat_service_v3:NeedsClarificationError: NÒo entendi sua pergunta. Pode reformular de forma mais especÝfica? Por exemplo: 'Quais as vendas da loja 1685?' ou 'Mostre o estoque de tecidos'
=== INICIANDO TESTE DECEP KNOWLEDGE (1000% CHECK) ===

--- QUERY: Quais colunas vocÛ tem acesso no banco de dados? ---
RESPOSTA TYPE: clarification_needed
MENSAGEM: NÒo entendi sua pergunta. Pode reformular de forma mais especÝfica? Por exemplo: 'Quais as vendas da loja 1685?' ou 'Mostre o estoque de tecidos'...
Traceback (most recent call last):
  File "C:\Agente_BI\BI_Solution\backend\test_deep_knowledge.py", line 54, in test_deep_knowledge
    print("\u274c TESTE 1 (SCHEMA): FALHOU (NÒo listou colunas)")
  File "C:\Program Files\Python311\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u274c' in position 0: character maps to <undefined>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Agente_BI\BI_Solution\backend\test_deep_knowledge.py", line 71, in <module>
    asyncio.run(test_deep_knowledge())
  File "C:\Program Files\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\asyncio\base_events.py", line 650, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Agente_BI\BI_Solution\backend\test_deep_knowledge.py", line 64, in test_deep_knowledge
    print(f"\u274c ERRO GRAVE: {e}")
  File "C:\Program Files\Python311\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u274c' in position 0: character maps to <undefined>
